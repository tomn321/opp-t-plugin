
http:
  routers:
    my-router:
      rule: "Host(`docker.localhost`) && PathPrefix(`/`)"
      entryPoints:
        - web
        - web-secure
      service: "my-service"
      middlewares:
        - redirect
        - bot-ratelimit
        - bot-retrylimit
        # - ua-guard-go@file
        - UAGuard@file



  services:
    my-service:
      loadBalancer:
        servers:
          - url: "http://docker.localhost:8080"

  middlewares:
    redirect:
      redirectScheme:
        scheme: https
    UAGuard:
      plugin:
        UAGuard:
          Headers:
            Tom: Nguyen
    # ua-guard-go:
    #   plugin:
    #     ua-guard:
    #       headers:
    #         user-agent: chrome
    bot-ratelimit:
      rateLimit:
        average: 15
        burst: 30
    bot-retrylimit:
      retry:
        attempts: 4
        initialInterval: 100ms

  # middlewareChains:
  #   block-bots:
  #     middlewares:
  #       - opa-go
  #       - bot-ratelimit
  #       - bot-retrylimit